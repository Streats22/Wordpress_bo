"use strict";
/*!
* Copyright (C) Oh!Fuchs, if not stated otherwise
* Written by Patrick Paul, Oh!Fuchs, Apparelcuts <patrick@ohfuchs.com> 2015-2019
*/wp.hooks.addAction("sfw.register.plugins","sfw.plugin.basket",function(n,t){var i=!1;wp.hooks.addAction("sfw.ready","sfw.floating-basket",function(){if(!n.get("disable-floating-basket")&&!t("[data-basket]").length){i=t('<div id="sfw-floating-basket" class="sfw"></div>');var a=t('<div class="--quick-summary grid-x"></div>'),e=t('<div class="cell auto"></div>');t('<span class="--label"></span>').append('<i class="ac ac-cart"></i> '+n._x("Cart","floating basket","apparelcuts-spreadshirt")).append('<span class="show-for-basket --item-count"><span data-basket-quantity-label></span></span>').appendTo(e),a.append(e).append('<span data-checkout class="cell shrink show-for-basket">'+n._x("Checkout","floating basket checkout action","apparelcuts-spreadshirt")+"</span>").appendTo(i),t('<div class="--basket-wrapper"></div>').append("<div data-basket></div>").append('<div class="--closer">x</div>').prependTo(i);var s=t("body");a.on("click",".--label",function(){return i.toggleClass("--open")}),i.on("click",".--closer",function(){return i.removeClass("--open")}),s.append(i),wp.hooks.addAction("sfw.basket.item.added.now","sfw-floating-basket",function(){i.addClass("--open")})}},10)}),wp.hooks.addAction("sfw.register.plugins","sfw.plugin.basket",function(a,r){function c(a,e){return a=a.replace(/appearanceId=([0-9]+)/gim,"appearanceId="+e)}wp.hooks.addAction("sfw.refresh","sfw.image-box",function(){var s=[];r(".sfw-image-box").not("[data-sfw-rendered]").each(function(){var a=this,e=function(){var a=r.Deferred(),e=r(this),s=e.find(".--main-image"),n=e.find(".--image-list"),t=e.parents("article");if(n.on("click","img",function(){var a=r(this).clone().attr("sizes",s.find("img").attr("sizes"));a[0].complete?s.find("img").replaceWith(a):a[0].onload=function(){s.find("img").replaceWith(a)}}),t.length&&wp.hooks.applyFilters("sfw.image-box.sync-appearance",!0,e,t)){var i=function(s){e.find("img").each(function(){var a=r(this),e=a.clone();e.attr("src",c(e.attr("src"),s)),e.attr("srcset",c(e.attr("srcset"),s)),e[0].complete?a.replaceWith(e):e[0].onload=function(){a.replaceWith(e)}})},o=t.find('[name="appearance"]').val();o&&i(o),wp.hooks.addAction("sfw.forms.order.appearance.change","sfw.image-box",function(a,e,s){a.parents("article").is(t)&&i(e)})}return a.resolve()}.call(this);s.push(e),e.done(function(){return r(a).attr("data-sfw-rendered",!0)})}),r.when(s).always(function(){return wp.hooks.doAction("sfw.image-box.renderedAll")})})});